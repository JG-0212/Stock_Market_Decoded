2025-04-30 12:05:00,682 - evaluator - INFO - Updated score for AAPL: 2426.6825493193564
2025-04-30 12:05:01,250 - evaluator - INFO - Updated score for GOOG: 1132.0444660216344
2025-04-30 12:05:01,652 - evaluator - INFO - Updated score for MSFT: 39576.75480621047
ed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
YF.download() has changed argument auto_adjust default to True
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 8774.69it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 2933.08it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00,  5.88it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00,  5.88it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00,  5.86it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 20.65it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 20.47it/s]
[*********************100%***********************]  1 of 1 completed
/home/jayagowtham/Documents/mlapp/frontend_utils.py:31: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 55.29it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 52.78it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 121.86it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 118.25it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 44.23it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 43.53it/s]
[*********************100%***********************]  1 of 1 completed
/home/jayagowtham/Documents/mlapp/frontend_utils.py:31: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 196.65it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 191.07it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 79.59it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 78.25it/s]
Downloading artifacts:   0%|          | 0/1 [00:00<?, ?it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 112.06it/s]Downloading artifacts: 100%|██████████| 1/1 [00:00<00:00, 109.73it/s]
Triggering DVC for AAPL (score=2426.6825493193564)
Running stage 'fetch':
> python3 ../scripts/fetch.py
[*********************100%***********************]  1 of 1 completed
YF.download() has changed argument auto_adjust default to True
🏃 View run AAPL_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/b4a2a50100514968979d1678845cc1dd
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'preprocess':
> python3 ../scripts/preprocess.py
Mean: [0.38673715]
Max 1.0000000000000002
Min 0.0
Std dev: [0.31432442]
🏃 View run AAPL_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/b4a2a50100514968979d1678845cc1dd
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'train':
> python3 ../scripts/train.py
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745994918.050582   24796 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745994918.055341   24796 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1745994918.069370   24796 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994918.069409   24796 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994918.069413   24796 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994918.069415   24796 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
Plotting train data plots
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 3, 100)         │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 3, 100)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 3, 50)          │        30,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 3, 50)          │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_2 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 50)             │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_3 (Dropout)             │ (None, 50)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 1)              │            51 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 111,451 (435.36 KB)
 Trainable params: 111,451 (435.36 KB)
 Non-trainable params: 0 (0.00 B)
Epoch 1/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m12:19[0m 5s/step - loss: 0.3300[1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - loss: 0.2268  [1m 24/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.2003[1m 31/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1864[1m 38/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1745[1m 44/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1656[1m 50/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1575[1m 56/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1502[1m 62/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1435[1m 68/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1374[1m 74/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1319[1m 80/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1269[1m 86/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1224[1m 92/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1182[1m 97/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1150[1m103/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1115[1m109/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1082[1m114/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1056[1m120/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1027[1m126/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 8ms/step - loss: 0.1000[1m132/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 8ms/step - loss: 0.0975[1m138/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0951[1m144/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0929[1m150/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0908[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m7s[0m 16ms/step - loss: 0.0901 - val_loss: 0.0145
Epoch 2/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m7s[0m 47ms/step - loss: 0.0041[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0103 [1m 12/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0104[1m 17/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0101[1m 22/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0098[1m 27/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0101[1m 33/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0103[1m 39/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0105[1m 45/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0106[1m 51/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0107[1m 57/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0107 [1m 63/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0107[1m 69/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0107[1m 75/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0106[1m 81/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0106[1m 86/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0105[1m 91/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0105[1m 96/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0104[1m102/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0104[1m108/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0104[1m114/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0103[1m120/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0103[1m126/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 10ms/step - loss: 0.0102[1m132/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 10ms/step - loss: 0.0102[1m137/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0102[1m142/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0102[1m148/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 10ms/step - loss: 0.0101[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 12ms/step - loss: 0.0101 - val_loss: 0.0166
Epoch 3/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 39ms/step - loss: 0.0011[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0039 [1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0047[1m 19/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0048[1m 25/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0051[1m 31/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0053[1m 37/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0054[1m 43/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0055[1m 49/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0057[1m 55/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0058[1m 61/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0059[1m 66/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0059[1m 72/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0060[1m 78/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0060[1m 79/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0060[1m 86/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0061[1m 93/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0061[1m100/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0061[1m107/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0061[1m114/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0062[1m121/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - loss: 0.0062 [1m128/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - loss: 0.0063[1m135/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0063[1m141/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 9ms/step - loss: 0.0063[1m147/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 9ms/step - loss: 0.0064[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 11ms/step - loss: 0.0064 - val_loss: 0.0213
Epoch 4/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 39ms/step - loss: 0.0022[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0048 [1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0056[1m 19/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0064[1m 25/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0069[1m 31/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0071[1m 37/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0073[1m 43/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0075[1m 49/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0076[1m 54/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0077[1m 59/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0077[1m 64/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0078[1m 69/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m 74/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m 79/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m 85/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m 90/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m 96/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m102/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m107/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m113/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0079[1m119/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m125/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m131/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m137/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m143/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m149/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 10ms/step - loss: 0.0078[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 11ms/step - loss: 0.0078 - val_loss: 0.0149
Epoch 4: early stopping
2025/04/30 12:05:35 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.
[31m2025/04/30 12:05:43 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.[0m
Registered model 'AAPLPredModel' already exists. Creating a new version of this model...
2025/04/30 12:05:44 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: AAPLPredModel, version 5
Created version '5' of model 'AAPLPredModel'.
19/19 - 0s - 5ms/step - loss: 0.0149
Plotting loss curve...
[1m 1/19[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m10s[0m 573ms/step[1m17/19[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 3ms/step   [1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 29ms/step[1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 30ms/step
/home/jayagowtham/Documents/mlapp/AAPL/../scripts/train.py:161: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
Plotting predictions...
🏃 View run AAPL_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/b4a2a50100514968979d1678845cc1dd
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
ERROR: failed to reproduce 'train':  output '../data/AAPL/AAPL_price_split.png' is already tracked by SCM (e.g. Git).
    You can remove it from Git, then add to DVC.
        To stop tracking from Git:
            git rm -r --cached '../data/AAPL/AAPL_price_split.png'
            git commit -m "stop tracking ../data/AAPL/AAPL_price_split.png" 
Triggering DVC for GOOG (score=1132.0444660216344)
Running stage 'fetch':
> python3 ../scripts/fetch.py
[*********************100%***********************]  1 of 1 completed
YF.download() has changed argument auto_adjust default to True
🏃 View run GOOG_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/c4833b64c3344de1862932e24e644dc2
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'preprocess':
> python3 ../scripts/preprocess.py
Mean: [0.35933715]
Max 1.0
Min 0.0
Std dev: [0.28895257]
🏃 View run GOOG_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/c4833b64c3344de1862932e24e644dc2
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'train':
> python3 ../scripts/train.py
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745994967.244760   25505 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745994967.252217   25505 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1745994967.269635   25505 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994967.269698   25505 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994967.269705   25505 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745994967.269709   25505 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
Plotting train data plots
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 3, 100)         │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 3, 100)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 3, 50)          │        30,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 3, 50)          │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_2 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 50)             │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_3 (Dropout)             │ (None, 50)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 1)              │            51 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 111,451 (435.36 KB)
 Trainable params: 111,451 (435.36 KB)
 Non-trainable params: 0 (0.00 B)
Epoch 1/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m14:45[0m 6s/step - loss: 0.0707[1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - loss: 0.1330  [1m 24/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1281[1m 32/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1208[1m 40/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1140[1m 48/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1078[1m 55/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1028[1m 62/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.0981[1m 69/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.0940[1m 76/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0902[1m 82/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0872[1m 88/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0845[1m 94/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0820[1m100/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0797[1m106/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0775[1m112/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0755[1m118/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0736[1m124/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 7ms/step - loss: 0.0719[1m131/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 8ms/step - loss: 0.0700[1m138/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0682[1m144/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0668[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 8ms/step - loss: 0.0652[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m8s[0m 15ms/step - loss: 0.0650 - val_loss: 0.0020
Epoch 2/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 37ms/step - loss: 0.0076[1m  6/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0070[1m 10/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 13ms/step - loss: 0.0068[1m 12/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 17ms/step - loss: 0.0068[1m 15/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 17ms/step - loss: 0.0067[1m 20/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m2s[0m 16ms/step - loss: 0.0067[1m 25/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 15ms/step - loss: 0.0068[1m 30/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 14ms/step - loss: 0.0067[1m 36/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 13ms/step - loss: 0.0067[1m 42/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 13ms/step - loss: 0.0066[1m 48/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1s[0m 12ms/step - loss: 0.0066[1m 53/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m1s[0m 12ms/step - loss: 0.0066[1m 59/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m1s[0m 12ms/step - loss: 0.0066[1m 65/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 12ms/step - loss: 0.0066[1m 71/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 11ms/step - loss: 0.0067[1m 77/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 11ms/step - loss: 0.0067[1m 84/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 11ms/step - loss: 0.0068[1m 90/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 11ms/step - loss: 0.0068[1m 97/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 11ms/step - loss: 0.0068[1m103/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0068[1m110/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0068[1m116/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0068[1m123/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 10ms/step - loss: 0.0069[1m130/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 10ms/step - loss: 0.0069[1m136/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0069[1m142/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 10ms/step - loss: 0.0070[1m149/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 10ms/step - loss: 0.0070[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 11ms/step - loss: 0.0070 - val_loss: 0.0037
Epoch 3/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 34ms/step - loss: 0.0037[1m  8/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 8ms/step - loss: 0.0048 [1m 15/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 8ms/step - loss: 0.0054[1m 22/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 8ms/step - loss: 0.0058[1m 29/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0061[1m 36/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0062[1m 43/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0063[1m 50/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0064[1m 57/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0065[1m 64/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 71/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m 78/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m 85/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m 92/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m 99/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m106/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m112/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m118/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m124/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m130/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 8ms/step - loss: 0.0067[1m136/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m142/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m148/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 10ms/step - loss: 0.0066 - val_loss: 0.0127
Epoch 4/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m5s[0m 40ms/step - loss: 0.0106[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0083 [1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0071[1m 19/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0066[1m 24/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0064[1m 29/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0063[1m 35/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0062[1m 40/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0061[1m 46/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0061[1m 51/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0061[1m 57/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0062[1m 63/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0062[1m 69/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0062[1m 75/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0062[1m 81/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m 87/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m 93/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m 99/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m105/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m111/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m117/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0063[1m123/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - loss: 0.0063 [1m129/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0063[1m135/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0063[1m142/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 9ms/step - loss: 0.0062[1m148/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 9ms/step - loss: 0.0062[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 11ms/step - loss: 0.0062 - val_loss: 0.0165
Epoch 4: early stopping
2025/04/30 12:06:26 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.
[31m2025/04/30 12:06:33 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.[0m
Registered model 'GOOGPredModel' already exists. Creating a new version of this model...
2025/04/30 12:06:33 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: GOOGPredModel, version 8
Created version '8' of model 'GOOGPredModel'.
19/19 - 0s - 5ms/step - loss: 0.0165
Plotting loss curve...
[1m 1/19[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m9s[0m 506ms/step[1m18/19[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 3ms/step  [1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 41ms/step[1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 42ms/step
/home/jayagowtham/Documents/mlapp/GOOG/../scripts/train.py:161: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
Plotting predictions...
🏃 View run GOOG_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/c4833b64c3344de1862932e24e644dc2
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
ERROR: failed to reproduce 'train':  output '../data/GOOG/GOOG_price_split.png' is already tracked by SCM (e.g. Git).
    You can remove it from Git, then add to DVC.
        To stop tracking from Git:
            git rm -r --cached '../data/GOOG/GOOG_price_split.png'
            git commit -m "stop tracking ../data/GOOG/GOOG_price_split.png" 
Triggering DVC for MSFT (score=39576.75480621047)
Running stage 'fetch':
> python3 ../scripts/fetch.py
[*********************100%***********************]  1 of 1 completed
YF.download() has changed argument auto_adjust default to True
🏃 View run MSFT_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/3e96461087194904b1d626f7da2a924d
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'preprocess':
> python3 ../scripts/preprocess.py
Mean: [0.39746695]
Max 1.0
Min 0.0
Std dev: [0.29311597]
🏃 View run MSFT_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/3e96461087194904b1d626f7da2a924d
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
Updating lock file 'dvc.lock'

Running stage 'train':
> python3 ../scripts/train.py
WARNING: All log messages before absl::InitializeLog() is called are written to STDERR
E0000 00:00:1745995015.800051   26221 cuda_dnn.cc:8579] Unable to register cuDNN factory: Attempting to register factory for plugin cuDNN when one has already been registered
E0000 00:00:1745995015.805900   26221 cuda_blas.cc:1407] Unable to register cuBLAS factory: Attempting to register factory for plugin cuBLAS when one has already been registered
W0000 00:00:1745995015.820300   26221 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745995015.820343   26221 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745995015.820348   26221 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
W0000 00:00:1745995015.820351   26221 computation_placer.cc:177] computation placer already registered. Please check linkage and avoid linking the same target more than once.
Plotting train data plots
Model: "sequential"
┏━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━━━━━━━━━━┳━━━━━━━━━━━━━━━┓
┃ Layer (type)                    ┃ Output Shape           ┃       Param # ┃
┡━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━━━━━━━━━━╇━━━━━━━━━━━━━━━┩
│ lstm (LSTM)                     │ (None, 3, 100)         │        40,800 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout (Dropout)               │ (None, 3, 100)         │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_1 (LSTM)                   │ (None, 3, 50)          │        30,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_1 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_2 (LSTM)                   │ (None, 3, 50)          │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_2 (Dropout)             │ (None, 3, 50)          │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ lstm_3 (LSTM)                   │ (None, 50)             │        20,200 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dropout_3 (Dropout)             │ (None, 50)             │             0 │
├─────────────────────────────────┼────────────────────────┼───────────────┤
│ dense (Dense)                   │ (None, 1)              │            51 │
└─────────────────────────────────┴────────────────────────┴───────────────┘
 Total params: 111,451 (435.36 KB)
 Trainable params: 111,451 (435.36 KB)
 Non-trainable params: 0 (0.00 B)
Epoch 1/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m14:15[0m 6s/step - loss: 0.1785[1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 4ms/step - loss: 0.1917  [1m 24/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1760[1m 32/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1647[1m 40/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 5ms/step - loss: 0.1549[1m 47/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1471[1m 54/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1399[1m 61/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 6ms/step - loss: 0.1334[1m 67/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1282[1m 73/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1235[1m 79/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1191[1m 85/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1151[1m 91/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1114[1m 97/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1080[1m103/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.1049[1m108/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.1025[1m114/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0997[1m120/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0971[1m127/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 8ms/step - loss: 0.0943[1m134/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 8ms/step - loss: 0.0917[1m141/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0893[1m147/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0873[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m8s[0m 15ms/step - loss: 0.0858 - val_loss: 0.0033
Epoch 2/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6s[0m 44ms/step - loss: 0.0163[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0135 [1m 12/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0135[1m 17/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0134[1m 23/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0133[1m 28/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0131[1m 33/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0129[1m 39/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0127[1m 45/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m1s[0m 10ms/step - loss: 0.0125[1m 51/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0124[1m 57/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 10ms/step - loss: 0.0122[1m 63/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0121 [1m 69/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0119[1m 75/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0118[1m 81/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0117[1m 87/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0116[1m 93/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0115[1m 99/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0114[1m105/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0113[1m111/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0112[1m117/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0111[1m123/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - loss: 0.0110[1m129/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0110[1m134/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0109[1m140/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 9ms/step - loss: 0.0108[1m146/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 9ms/step - loss: 0.0107[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - loss: 0.0107[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 12ms/step - loss: 0.0107 - val_loss: 0.0302
Epoch 3/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m6s[0m 45ms/step - loss: 0.0120[1m  7/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0074 [1m 13/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0071[1m 19/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0075[1m 25/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0078[1m 31/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0079[1m 37/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m1s[0m 9ms/step - loss: 0.0078[1m 43/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0078[1m 49/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0077[1m 55/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0077[1m 61/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0076[1m 67/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0075[1m 73/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0075[1m 78/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0074[1m 84/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0074[1m 90/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0073[1m 96/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0072[1m103/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0072[1m110/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0071[1m116/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 9ms/step - loss: 0.0071[1m123/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 9ms/step - loss: 0.0071[1m130/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 9ms/step - loss: 0.0070[1m137/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 9ms/step - loss: 0.0070[1m144/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 9ms/step - loss: 0.0069[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 9ms/step - loss: 0.0069[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 11ms/step - loss: 0.0069 - val_loss: 0.0246
Epoch 4/100
[1m  1/151[0m [37m━━━━━━━━━━━━━━━━━━━━[0m [1m4s[0m 32ms/step - loss: 0.0032[1m  8/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m1s[0m 7ms/step - loss: 0.0038 [1m 15/151[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0052[1m 22/151[0m [32m━━[0m[37m━━━━━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0059[1m 29/151[0m [32m━━━[0m[37m━━━━━━━━━━━━━━━━━[0m [1m0s[0m 7ms/step - loss: 0.0062[1m 36/151[0m [32m━━━━[0m[37m━━━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0064[1m 43/151[0m [32m━━━━━[0m[37m━━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0065[1m 50/151[0m [32m━━━━━━[0m[37m━━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 57/151[0m [32m━━━━━━━[0m[37m━━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 64/151[0m [32m━━━━━━━━[0m[37m━━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 71/151[0m [32m━━━━━━━━━[0m[37m━━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 78/151[0m [32m━━━━━━━━━━[0m[37m━━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 85/151[0m [32m━━━━━━━━━━━[0m[37m━━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 92/151[0m [32m━━━━━━━━━━━━[0m[37m━━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m 99/151[0m [32m━━━━━━━━━━━━━[0m[37m━━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m106/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m112/151[0m [32m━━━━━━━━━━━━━━[0m[37m━━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m118/151[0m [32m━━━━━━━━━━━━━━━[0m[37m━━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m124/151[0m [32m━━━━━━━━━━━━━━━━[0m[37m━━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m130/151[0m [32m━━━━━━━━━━━━━━━━━[0m[37m━━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m136/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m142/151[0m [32m━━━━━━━━━━━━━━━━━━[0m[37m━━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m148/151[0m [32m━━━━━━━━━━━━━━━━━━━[0m[37m━[0m [1m0s[0m 8ms/step - loss: 0.0066[1m151/151[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m2s[0m 10ms/step - loss: 0.0066 - val_loss: 0.0147
Epoch 4: early stopping
2025/04/30 12:07:13 WARNING mlflow.keras.save: You are saving a Keras model without specifying model signature.
[31m2025/04/30 12:07:21 WARNING mlflow.models.model: Model logged without a signature and input example. Please set `input_example` parameter when logging the model to auto infer the model signature.[0m
Registered model 'MSFTPredModel' already exists. Creating a new version of this model...
2025/04/30 12:07:22 INFO mlflow.store.model_registry.abstract_store: Waiting up to 300 seconds for model version to finish creation. Model name: MSFTPredModel, version 4
Created version '4' of model 'MSFTPredModel'.
19/19 - 0s - 5ms/step - loss: 0.0147
Plotting loss curve...
[1m 1/19[0m [32m━[0m[37m━━━━━━━━━━━━━━━━━━━[0m [1m11s[0m 648ms/step[1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m0s[0m 34ms/step  [1m19/19[0m [32m━━━━━━━━━━━━━━━━━━━━[0m[37m[0m [1m1s[0m 35ms/step
/home/jayagowtham/Documents/mlapp/MSFT/../scripts/train.py:161: FutureWarning: ``mlflow.tracking.client.MlflowClient.get_latest_versions`` is deprecated since 2.9.0. Model registry stages will be removed in a future major release. To learn more about the deprecation of model registry stages, see our migration guide here: https://mlflow.org/docs/latest/model-registry.html#migrating-from-stages
  version_info = client.get_latest_versions(model_name)[0]
Plotting predictions...
🏃 View run MSFT_2025-04-30 at: http://localhost:5000/#/experiments/393362287489782283/runs/3e96461087194904b1d626f7da2a924d
🧪 View experiment at: http://localhost:5000/#/experiments/393362287489782283
ERROR: failed to reproduce 'train':  output '../data/MSFT/MSFT_price_split.png' is already tracked by SCM (e.g. Git).
    You can remove it from Git, then add to DVC.
        To stop tracking from Git:
            git rm -r --cached '../data/MSFT/MSFT_price_split.png'
            git commit -m "stop tracking ../data/MSFT/MSFT_price_split.png" 
